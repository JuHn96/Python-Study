# ì‹¤ìŠµì½”ë“œ - 1

https://junstar92.tistory.com/95 

```python
import tensorflow as tf
import numpy as np
 
X = np.linspace(2, 10, num=50)
Y = np.random.rand(50)*10 + 2
Y.sort()
print('X = ', X)
print('Y = ', Y)

import matplotlib.pyplot as plt
plt.plot(X, Y, 'ro')
plt.show()

W = tf.Variable(np.zeros(()), name='weight')
b = tf.Variable(np.zeros(()), name='bias')

def linear_regression(x):
    return W*x + b
 
def mean_square(y_pred, y):
    return tf.reduce_mean(tf.square(y_pred - y))

epochs = 1000
optimizer = tf.optimizers.SGD()
 
for epoch in range(1, epochs + 1):
    with tf.GradientTape() as t:
        pred = linear_regression(X)
        loss = mean_square(pred, Y)
    
    # compute gradients
    gradients = t.gradient(loss, [W, b])
 
    # update W and b following gradients
    optimizer.apply_gradients(zip(gradients, [W, b]))
 
    if epoch % 50 == 0:
        print(f'{epoch} epoch : loss = {loss}, W = {W.numpy()}, b = {b.numpy()}')

plt.plot(X, Y, 'ro', label='Origin data')
plt.plot(X, np.array(W*X + b), label='Fitted line')
plt.legend()

plt.show()
```

### âœ… ìš”ì•½ ì„¤ëª…

- **ë¶‰ì€ ì ** = ì›ë˜ ë°ì´í„° (ì •ë‹µ)
- **íŒŒë€ ì„ ** = ëª¨ë¸ì´ í•™ìŠµì„ í†µí•´ ì°¾ì€ ì˜ˆì¸¡ ì§ì„ 

ì´ ì½”ë“œëŠ”

**2~10 ì‚¬ì´ì˜ ìˆ«ì(X)**ì™€ **ëœë¤í•˜ê²Œ ì¦ê°€í•˜ëŠ” ê°’(Y)** ìœ¼ë¡œ êµ¬ì„±ëœ **ê°€ìƒì˜ ë°ì´í„°**ì— ëŒ€í•´,

â†’ **ì„ í˜•íšŒê·€(ì§ì„ )ë¥¼ í•™ìŠµì‹œì¼œ**

â†’ `Y = WX + b` í˜•íƒœì˜ **ëª¨ë¸ì„ ë§Œë“¤ê³ **

â†’ ì˜ˆì¸¡ê°’ì´ ì›ë˜ ë°ì´í„°ì™€ ì˜ ë§ëŠ”ì§€ **ì§ì„  ê·¸ë˜í”„ë¡œ ì‹œê°í™”**í•œ ì˜ˆì œ.

ë¶„ë¥˜ê°€ ì•„ë‹ˆë¼ **íšŒê·€(regression)** ë¬¸ì œ.

ì¦‰, ê°’ì„ ì˜ˆì¸¡í•˜ëŠ” ë¬¸ì œ.

- ì˜ ì˜ˆì¸¡ëœ ê²½ìš°.

![ex1](ex1.png)

![ex2](ex2.png)

---

# ì‹¤ìŠµì½”ë“œ - 2 

**í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬**

pip install matplotlib scikit-learn pandas

```python
# 1. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
import matplotlib.pyplot as plt
import pandas as pd
from sklearn.datasets import load_diabetes
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score

# 2. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
diabetes = load_diabetes()
X = pd.DataFrame(diabetes.data, columns=diabetes.feature_names)
y = diabetes.target

# 3. íŠ¹ì • íŠ¹ì„±ë§Œ ì‚¬ìš©í•´ì„œ ë‹¨ìˆœ ì„ í˜• íšŒê·€ (ì˜ˆ: 'bmi')
X_bmi = X[['bmi']]  # body mass index

# 4. ë°ì´í„° ë¶„í• 
X_train, X_test, y_train, y_test = train_test_split(X_bmi, y, test_size=0.2, random_state=42)

# 5. ëª¨ë¸ í•™ìŠµ
model = LinearRegression()
model.fit(X_train, y_train)

# 6. ì˜ˆì¸¡
y_pred = model.predict(X_test)

# 7. ì„±ëŠ¥ í‰ê°€
print("Mean Squared Error (MSE):", mean_squared_error(y_test, y_pred))
print("R2 Score:", r2_score(y_test, y_pred))

# 8. íšŒê·€ì„  ì‹œê°í™”
plt.scatter(X_test, y_test, color='blue', label='Actual')
plt.plot(X_test, y_pred, color='red', linewidth=2, label='Regression Line')
plt.xlabel('BMI')
plt.ylabel('Disease Progression')
plt.title('Linear Regression on BMI')
plt.legend()
plt.grid(True)
plt.show()

```

### ğŸ¯ ëª©ì :

- "ì‚¬ëŒì˜ BMI(ì²´ì§ˆëŸ‰ì§€ìˆ˜)ë¥¼ ë³´ê³ , ë‹¹ë‡¨ë³‘ ì§„í–‰ ì •ë„ë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆì„ê¹Œ?"

### ğŸ¯ ì½”ë“œ ìš”ì•½

- ë¨¸ì‹ ëŸ¬ë‹ì˜ ê¸°ë³¸ êµ¬ì¡° (ë°ì´í„° â†’ í•™ìŠµ â†’ ì˜ˆì¸¡ â†’ í‰ê°€)

### ğŸ¯ ê²°ê³¼ ìš”ì•½

![ex3](ex3.png)

### ğŸ”µ íŒŒë€ ì ë“¤ (Actual)

- `X`: í™˜ìì˜ **BMI (ì²´ì§ˆëŸ‰ì§€ìˆ˜)**
- `Y`: ë‹¹ë‡¨ë³‘ **ì§ˆë³‘ ì§„í–‰ ì •ë„ (Disease Progression)**
- ì´ ì ë“¤ì€ ì‹¤ì œ ë°ì´í„°ì…‹(`load_diabetes()`)ì—ì„œ ë‚˜ì˜¨ **ì‹¤ì œ ê´€ì¸¡ê°’ë“¤**ì…ë‹ˆë‹¤.

### ğŸ”´ ë¹¨ê°„ ì„  (Regression Line)

- **ì„ í˜• íšŒê·€ ëª¨ë¸**ì´ í•™ìŠµì„ í†µí•´ ì°¾ì•„ë‚¸ ì§ì„ ì…ë‹ˆë‹¤.
- ìˆ˜ì‹ í˜•íƒœëŠ” `y = Wx + b` (BMIê°€ ë†’ì•„ì§ˆìˆ˜ë¡ ì˜ˆì¸¡ë˜ëŠ” ì§ˆë³‘ ì§„í–‰ ì •ë„ë„ ì¦ê°€)

---

## âœ… ê²°ê³¼ ìš”ì•½

- **ëª©í‘œ**: BMI(ì²´ì§ˆëŸ‰ì§€ìˆ˜)ë§Œ ê°€ì§€ê³  ë‹¹ë‡¨ë³‘ ì§„í–‰ ì •ë„ë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸
- **ê²°ê³¼ í•´ì„**:
    - ë¹¨ê°„ ì„ ì€ ë°ì´í„°ì˜ **ì „ë°˜ì ì¸ ê²½í–¥(ì¶”ì„¸ì„ )** ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
    - íŒŒë€ ì ë“¤ì´ ì„ ì— ê°€ê¹Œìš¸ìˆ˜ë¡, ëª¨ë¸ì´ ì˜ˆì¸¡ì„ ì˜í•œ ê²ƒì…ë‹ˆë‹¤.
    - ì ë“¤ì´ í©ì–´ì ¸ ìˆëŠ” ì •ë„(ì‚°í¬)ë¥¼ ë³´ë©´, BMI í•˜ë‚˜ë§Œìœ¼ë¡œëŠ” ì •í™•í•œ ì˜ˆì¸¡ì€ ì–´ë µì§€ë§Œ **ì–´ëŠ ì •ë„ ê²½í–¥ì„±ì€ ìˆìŒ**ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
    - ì˜ ì˜ˆì¸¡ë˜ì§€ ì•Šì€ ê²½ìš°.